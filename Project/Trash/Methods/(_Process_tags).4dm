//%attributes = {"invisible":true,"preemptive":"capable"}  // ----------------------------------------------------  // Project method : Process_tags  // Database: 4D Mobile Express  // ID[CF26D63F6DF3493D9224934C8492CD74]  // Created 12-6-2017 by Vincent de Lachaux  // ----------------------------------------------------  // Description:  // -  // ----------------------------------------------------  // DeclarationsC_TEXT:C284($0)C_TEXT:C284($1)C_OBJECT:C1216($2)C_COLLECTION:C1488($3)C_LONGINT:C283($i;$Lon_parameters)C_TEXT:C284($t;$Txt_in;$Txt_out)C_OBJECT:C1216($o;$Obj_element;$Obj_field;$Obj_table;$Obj_tags)C_COLLECTION:C1488($Col_types)If (False:C215)	C_TEXT:C284(Process_tags ;$0)	C_TEXT:C284(Process_tags ;$1)	C_OBJECT:C1216(Process_tags ;$2)	C_COLLECTION:C1488(Process_tags ;$3)End if   // ----------------------------------------------------  // Initialisations$Lon_parameters:=Count parameters:C259If (Asserted:C1132($Lon_parameters>=3;"Missing parameter"))		  // Required parameters	$Txt_in:=$1	$Obj_tags:=$2	$Col_types:=$3		  // Optional parameters	If ($Lon_parameters>=4)				  // <NONE>			End if 		$Txt_out:=$Txt_in	$Obj_table:=$Obj_tags.table		$o:=str   // class	Else 		ABORT:C156	End if   // ----------------------------------------------------Case of   // According to type replace the tag				  //______________________________________________________	: ($Col_types.indexOf("swift")#-1)  // Sources file header (*.swift)				$Txt_out:=Replace string:C233($Txt_out;"___DATE___";String:C10($Obj_tags.date))		$Txt_out:=Replace string:C233($Txt_out;"___FULLUSERNAME___";String:C10($Obj_tags.fullname))		$Txt_out:=Replace string:C233($Txt_out;"___PACKAGENAME___";String:C10($Obj_tags.packageName))		$Txt_out:=Replace string:C233($Txt_out;"___COPYRIGHT___";String:C10($Obj_tags.copyright))				  //______________________________________________________	: ($Col_types.indexOf("Info.plist")#-1)				  // The following file could be edited using /usr/libexec/PListBuddy, plutil or default		  // Info.plist				$Txt_out:=Replace string:C233($Txt_out;"___DEVELOPMENT_REGION___";String:C10($Obj_tags.developmentRegion))		$Txt_out:=Replace string:C233($Txt_out;"___PROJECT_DISPLAY_NAME___";String:C10($Obj_tags.displayName))		$Txt_out:=Replace string:C233($Txt_out;"___VERSION___";String:C10($Obj_tags.version))		$Txt_out:=Replace string:C233($Txt_out;"___BUILD_NUMBER___";String:C10($Obj_tags.build))		$Txt_out:=Replace string:C233($Txt_out;"___STORYBOARD_LAUNCH_SCREEN___";String:C10($Obj_tags.storyboardLaunchScreen))		$Txt_out:=Replace string:C233($Txt_out;"___STORYBOARD_MAIN___";String:C10($Obj_tags.storyboardMain))		$Txt_out:=Replace string:C233($Txt_out;"___URL_SCHEME___";String:C10($Obj_tags.urlScheme))				$Txt_out:=Replace string:C233($Txt_out;"___COMPONENT_BUILD___";String:C10($Obj_tags.componentBuild))		$Txt_out:=Replace string:C233($Txt_out;"___IDE_VERSION___";String:C10($Obj_tags.ideVersion))		$Txt_out:=Replace string:C233($Txt_out;"___IDE_BUILD_VERSION___";String:C10($Obj_tags.ideBuildVersion))		$Txt_out:=Replace string:C233($Txt_out;"___SDK_VERSION___";String:C10($Obj_tags.sdkVersion))				  //______________________________________________________	: ($Col_types.indexOf("settings")#-1)				$Txt_out:=Replace string:C233($Txt_out;"___SERVER_URL___";String:C10($Obj_tags.prodUrl))		$Txt_out:=Replace string:C233($Txt_out;"___SERVER_PORT___";String:C10($Obj_tags.serverPort))		$Txt_out:=Replace string:C233($Txt_out;"___SERVER_URL_SCHEME___";String:C10($Obj_tags.serverScheme))		$Txt_out:=Replace string:C233($Txt_out;"___SERVER_HTTPS_PORT___";String:C10($Obj_tags.serverHTTPSPort))		$Txt_out:=Replace string:C233($Txt_out;"___SERVER_URLS___";String:C10($Obj_tags.serverUrls))				  // has login form		$Txt_out:=Replace string:C233($Txt_out;"___SERVER_AUTHENTIFICATION_EMAIL___";String:C10($Obj_tags.serverAuthenticationEmail))		$Txt_out:=Replace string:C233($Txt_out;"___SERVER_AUTHENTIFICATION_RELOAD_DATA___";String:C10($Obj_tags.serverAuthenticationReloadData))				  // An unique UUID created for a new generated app		$Txt_out:=Replace string:C233($Txt_out;"___SETTING_UUID___";Generate UUID:C1066)				  //______________________________________________________	: ($Col_types.indexOf("asset")#-1)				$Txt_out:=Replace string:C233($Txt_out;"___NAME___";String:C10($Obj_tags.name))		$Txt_out:=Replace string:C233($Txt_out;"___FILE_NAME___";String:C10($Obj_tags.fileName))		$Txt_out:=Replace string:C233($Txt_out;"___UTI___";String:C10($Obj_tags.uti))		$Txt_out:=Replace string:C233($Txt_out;"___RED___";String:C10($Obj_tags.red))		$Txt_out:=Replace string:C233($Txt_out;"___BLUE___";String:C10($Obj_tags.blue))		$Txt_out:=Replace string:C233($Txt_out;"___GREEN___";String:C10($Obj_tags.green))		$Txt_out:=Replace string:C233($Txt_out;"___WHITE___";String:C10($Obj_tags.white))		$Txt_out:=Replace string:C233($Txt_out;"___ALPHA___";String:C10($Obj_tags.alpha))				  //______________________________________________________	: ($Col_types.indexOf("project.pbxproj")#-1)  // project.pbxproj				$Txt_out:=Replace string:C233($Txt_out;"___PRODUCT___";String:C10($Obj_tags.product))		$Txt_out:=Replace string:C233($Txt_out;"___PRODUCT_BUNDLE_IDENTIFIER___";String:C10($Obj_tags.bundleIdentifier))		$Txt_out:=Replace string:C233($Txt_out;"___ORGANIZATION___";String:C10($Obj_tags.company))		$Txt_out:=Replace string:C233($Txt_out;"___IPHONEOS_DEPLOYMENT_TARGET___";String:C10($Obj_tags.iosDeploymentTarget))		$Txt_out:=Replace string:C233($Txt_out;"___SWIFT_VERSION___";String:C10($Obj_tags.swiftVersion))		$Txt_out:=Replace string:C233($Txt_out;"___ENABLE_ON_DEMAND_RESOURCES___";String:C10($Obj_tags.onDemandResources))		$Txt_out:=Replace string:C233($Txt_out;"___ENABLE_BITCODE___";String:C10($Obj_tags.bitcode))		$Txt_out:=Replace string:C233($Txt_out;"___TARGETED_DEVICE_FAMILY___";String:C10($Obj_tags.targetedDeviceFamily))		$Txt_out:=Replace string:C233($Txt_out;"___OTHER_SWIFT_FLAGS_DEBUG___";String:C10($Obj_tags.swiftFlagsDebug))		$Txt_out:=Replace string:C233($Txt_out;"___OTHER_SWIFT_FLAGS_RELEASE___";String:C10($Obj_tags.swiftFlagsRelease))		$Txt_out:=Replace string:C233($Txt_out;"___SWIFT_OPTIMIZATION_LEVEL_DEBUG___";String:C10($Obj_tags.swiftOptimizationLevelDebug))		$Txt_out:=Replace string:C233($Txt_out;"___SWIFT_OPTIMIZATION_LEVEL_RELEASE___";String:C10($Obj_tags.swiftOptimizationLevelRelease))		$Txt_out:=Replace string:C233($Txt_out;"___SWIFT_COMPILATION_MODE_DEBUG___";String:C10($Obj_tags.swiftCompilationModeDebug))		$Txt_out:=Replace string:C233($Txt_out;"___SWIFT_COMPILATION_MODE_RELEASE___";String:C10($Obj_tags.swiftCompilationModeRelease))				If (String:C10($Obj_tags.teamId)#"")						$Txt_out:=Replace string:C233($Txt_out;"___DEVELOPMENT_TEAM___";$Obj_tags.teamId)					Else 						  // Remove the keys			$Txt_out:=Replace string:C233($Txt_out;"DevelopmentTeam = \"___DEVELOPMENT_TEAM___\";";"")			$Txt_out:=Replace string:C233($Txt_out;"DEVELOPMENT_TEAM = \"___DEVELOPMENT_TEAM___\";";"")					End if 				  // **************************** TEMPORARY ****************************		  // * all table files swift and storyboard must added to project      *		  // *******************************************************************		$Txt_out:=Replace string:C233($Txt_out;"___TABLE___";String:C10($Obj_table.name))				  //______________________________________________________	: ($Col_types.indexOf("filename")#-1)				$Txt_out:=Replace string:C233($Txt_out;"___PRODUCT___";String:C10($Obj_tags.product))		$Txt_out:=Replace string:C233($Txt_out;"___TABLE___";String:C10($Obj_table.name))		$Txt_out:=Replace string:C233($Txt_out;"___NAME___";String:C10($Obj_tags.name))				  //______________________________________________________	: ($Col_types.indexOf("navigation.storyboard")#-1)				$Txt_out:=Replace string:C233($Txt_out;"___NAVIGATION_TRANSITION___";String:C10($Obj_tags.navigationTransition))		$Txt_out:=Replace string:C233($Txt_out;"___NAVIGATION_TITLE___";String:C10($Obj_tags.navigationTitle))		$Txt_out:=Replace string:C233($Txt_out;"___NAVIGATION_TABLE_ROW_HEIGHT___";String:C10($Obj_tags.navigationRowHeight))				  //______________________________________________________	: ($Col_types.indexOf("script")#-1)				$Txt_out:=Replace string:C233($Txt_out;"___MINIMUM_XCODE_VERSION___";String:C10($Obj_tags.xCodeVersion))				  //______________________________________________________	: ($Col_types.indexOf("automatic")#-1)  // if pass a restricted tag object this add all keys				For each ($t;$Obj_tags)						Case of 										  //________________________________________				: (Value type:C1509($Obj_tags[$t])=Is collection:K8:32)										$Txt_out:=Replace string:C233($Txt_out;"___"+Uppercase:C13($t)+"___";$o.setText(JSON Stringify:C1217($Obj_tags[$t])).xmlEncode())										  //________________________________________				: (Value type:C1509($Obj_tags[$t])=Is object:K8:27)										$Txt_out:=Replace string:C233($Txt_out;"___"+Uppercase:C13($t)+"___";$o.setText(JSON Stringify:C1217($Obj_tags[$t])).xmlEncode())										  //________________________________________				Else 										$Txt_out:=Replace string:C233($Txt_out;"___"+Uppercase:C13($t)+"___";String:C10($Obj_tags[$t]))										  //________________________________________			End case 		End for each 				  //______________________________________________________	Else 				$Txt_out:=Replace string:C233($Txt_out;"___PRODUCT___";String:C10($Obj_tags.product))				  //______________________________________________________End case   //___TABLE___ FILES [If ($Col_types.indexOf("___TABLE___")#-1)  // ___TABLE___.* or file part		$Txt_out:=Replace string:C233($Txt_out;"___TABLE___";$Obj_table.name)		Case of 						  //______________________________________________________		: ($Col_types.indexOf("swift")#-1)  //___TABLE___.swift						$Txt_out:=Replace string:C233($Txt_out;"___DETAILFORMTYPE___";String:C10($Obj_tags.detailFormType))			$Txt_out:=Replace string:C233($Txt_out;"___LISTFORMTYPE___";String:C10($Obj_tags.listFormType))						For each ($Obj_field;$Obj_table.fields)								$i:=$i+1								$t:="___FIELD_"+String:C10($i)				$Txt_out:=Replace string:C233($Txt_out;$t+"___";$Obj_field.name)				$Txt_out:=Replace string:C233($Txt_out;$t+"_NAME___";$o.setText($Obj_field.originalName).xmlEncode())				$Txt_out:=Replace string:C233($Txt_out;$t+"_LABEL___";$o.setText($Obj_field.label).xmlEncode())				$Txt_out:=Replace string:C233($Txt_out;$t+"_SHORT_LABEL___";$o.setText($Obj_field.shortLabel).xmlEncode())				$Txt_out:=Replace string:C233($Txt_out;$t+"_BINDING_TYPE___";String:C10($Obj_field.bindingType))				$Txt_out:=Replace string:C233($Txt_out;$t+"_ICON___";$o.setText($Obj_field.detailIcon).xmlEncode())				$Txt_out:=Replace string:C233($Txt_out;$t+"_LABEL_ALIGNMENT___";String:C10($Obj_field.labelAlignment))							End for each 						  //______________________________________________________		: ($Col_types.indexOf("storyboard")#-1)  //___TABLE___XXX.storyboard						$t:=String:C10($Obj_table.navigationTransition)						If (Length:C16($t)=0)								$t:=String:C10($Obj_tags.navigationTransition)  // the default one							End if 						$Txt_out:=Replace string:C233($Txt_out;"___LIST_TO_DETAIL_TRANSITION___";$t)						$Txt_out:=Replace string:C233($Txt_out;"___SEARCHABLE_FIELD___";String:C10($Obj_table.searchableField))			$Txt_out:=Replace string:C233($Txt_out;"___SECTION_FIELD___";String:C10($Obj_table.sectionField))			$Txt_out:=Replace string:C233($Txt_out;"___SECTION_FIELD_BINDING_TYPE___";String:C10($Obj_table.sectionFieldBindingType))			$Txt_out:=Replace string:C233($Txt_out;"___SHOW_SECTION___";String:C10($Obj_table.showSection))			$Txt_out:=Replace string:C233($Txt_out;"___SORT_FIELD___";String:C10($Obj_table.sortField))						$Txt_out:=Replace string:C233($Txt_out;"___PRODUCT___";String:C10($Obj_tags.product))						$Txt_out:=Replace string:C233($Txt_out;"___TABLE_NUMBER___";String:C10($Obj_table.tableNumber))			$Txt_out:=Replace string:C233($Txt_out;"___TABLE_NAME___";$o.setText($Obj_table.originalName).xmlEncode())			$Txt_out:=Replace string:C233($Txt_out;"___TABLE_LABEL___";$o.setText($Obj_table.label).xmlEncode())			$Txt_out:=Replace string:C233($Txt_out;"___TABLE_SHORT_LABEL___";$o.setText($Obj_table.shortLabel).xmlEncode())			$Txt_out:=Replace string:C233($Txt_out;"___TABLE_ICON___";$o.setText($Obj_table.navigationIcon).xmlEncode())			$Txt_out:=Replace string:C233($Txt_out;"___TABLE_ACTIONS___";$o.setText($Obj_table.tableActions).xmlEncode())			$Txt_out:=Replace string:C233($Txt_out;"___ENTITY_ACTIONS___";$o.setText($Obj_table.recordActions).xmlEncode())						For each ($Obj_field;$Obj_table.fields)								$i:=$i+1				$t:="___FIELD_"+String:C10($i)								$Txt_out:=Replace string:C233($Txt_out;$t+"___";$Obj_field.name)				$Txt_out:=Replace string:C233($Txt_out;$t+"_NAME___";xml_encode (String:C10($Obj_field.originalName)))				$Txt_out:=Replace string:C233($Txt_out;$t+"_LABEL___";xml_encode (String:C10($Obj_field.label)))				$Txt_out:=Replace string:C233($Txt_out;$t+"_SHORT_LABEL___";xml_encode (String:C10($Obj_field.shortLabel)))				$Txt_out:=Replace string:C233($Txt_out;$t+"_BINDING_TYPE___";String:C10($Obj_field.bindingType))				$Txt_out:=Replace string:C233($Txt_out;$t+"_ICON___";xml_encode (String:C10($Obj_field.detailIcon)))				$Txt_out:=Replace string:C233($Txt_out;$t+"_LABEL_ALIGNMENT___";String:C10($Obj_field.labelAlignment))							End for each 						  //______________________________________________________		: ($Col_types.indexOf("detailform")#-1)  //___TABLE___DetailsForm.storyboard						If ($Obj_tags.field#Null:C1517)								$t:="___FIELD"				$Txt_out:=Replace string:C233($Txt_out;$t+"___";$Obj_tags.field.name)				$Txt_out:=Replace string:C233($Txt_out;$t+"_NAME___";xml_encode (String:C10($Obj_tags.field.originalName)))				$Txt_out:=Replace string:C233($Txt_out;$t+"_LABEL___";xml_encode ($Obj_tags.field.label))				$Txt_out:=Replace string:C233($Txt_out;$t+"_SHORT_LABEL___";xml_encode (String:C10($Obj_tags.field.shortLabel)))				$Txt_out:=Replace string:C233($Txt_out;$t+"_BINDING_TYPE___";String:C10($Obj_tags.field.bindingType))				$Txt_out:=Replace string:C233($Txt_out;$t+"_ICON___";xml_encode (String:C10($Obj_tags.field.detailIcon)))				$Txt_out:=Replace string:C233($Txt_out;$t+"_LABEL_ALIGNMENT___";String:C10($Obj_tags.field.labelAlignment))								If (Num:C11($Obj_tags.field.id)=0)					  // $Txt_out:=Replace string($Txt_out;$Txt_buffer+"_INVERSE___";String($Obj_tags.field.inverseName))  // if use field as relation, remove this line if use ($Obj_tags.relation#Null)					$Txt_out:=Replace string:C233($Txt_out;"___DESTINATION___";formatString ("table-name";String:C10($Obj_tags.field.relatedEntities)+"ListForm"))  // ?? if isRelationToMany change check this line									End if 							End if 						  //______________________________________________________		: ($Col_types.indexOf("navigation")#-1)  // MainNavigation.storyboard						$Txt_out:=Replace string:C233($Txt_out;"___TABLE_NAME___";xml_encode (String:C10($Obj_table.originalName)))			$Txt_out:=Replace string:C233($Txt_out;"___TABLE_LABEL___";xml_encode (String:C10($Obj_table.label)))			$Txt_out:=Replace string:C233($Txt_out;"___TABLE_SHORT_LABEL___";xml_encode (String:C10($Obj_table.shortLabel)))			$Txt_out:=Replace string:C233($Txt_out;"___TABLE_ICON___";xml_encode (String:C10($Obj_table.navigationIcon)))			$Txt_out:=Replace string:C233($Txt_out;"___TABLE_LABEL_ALIGNMENT___";String:C10($Obj_table.labelAlignment))						$Txt_out:=Replace string:C233($Txt_out;"TAG-ID-SEG";$Obj_table.segueDestinationId)						  //______________________________________________________	End case 	End if   //]If ($Col_types.indexOf("storyboardID")#-1)  // Dispatch storyboard id in TAG-<interfix>-<position>		If (Length:C16(String:C10($Obj_tags.tagInterfix))>0)  // only one element defined directly at root tag level		$Obj_element:=New object:C1471()		$Obj_element.tagInterfix:=$Obj_tags.tagInterfix  // no obcopy to avoid recursivity		$Obj_element.storyboardIDs:=$Obj_tags.storyboardIDs		$Obj_tags.storyboardID:=New collection:C1472($Obj_element)	End if 		If (Value type:C1509($Obj_tags.storyboardID)=Is collection:K8:32)  // we have a collection of storyboard ids to replace				For each ($Obj_element;$Obj_tags.storyboardID)						If (Length:C16(String:C10($Obj_element.tagInterfix))>0)								If (Value type:C1509($Obj_element.storyboardIDs)=Is collection:K8:32)										For ($i;0;$Obj_element.storyboardIDs.length-1;1)												$t:=String:C10($i+1;"##000")						$Txt_out:=Replace string:C233($Txt_out;"TAG-"+$Obj_element.tagInterfix+"-"+$t;$Obj_element.storyboardIDs[$i])											End for 									Else 										ASSERT:C1129(dev_Matrix ;"storyboardID tag replacement asked but not collection of it provided for "+String:C10($Obj_element.tagInterfix))									End if 							Else 								ASSERT:C1129(dev_Matrix ;"When replacing storyboard id no tag interfix provided (TAG-interfix-position)")							End if 		End for each 	End if End if   // ----------------------------------------------------  // Return$0:=$Txt_out  // ----------------------------------------------------  // End